%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Calibrated and Uncalibrated Photometric Stereo}\label{ch:bg_ps}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Photometric Stereo (PS)~\cite{woodham1980photometric} is a relaxation of the
Shape-from-Shading (SfS) problem in which multiple images under known, varying
illumination are required. The most common form of
PS~\cite{woodham1980photometric} assumes a Lambertian BRDF.\@ Given the natural
ill-posedness of the Lambertian SfS problem (as shown by
\labelcref{eq:bg_sfs_least_squares_lambert}), PS solves the problem by requiring
3 or more images under known illumination. Given 3+ images,
\cref{eq:bg_sfs_least_squares_lambert} becomes stable and an albedo per pixel 
may also be recovered. More precisely, a surface normal and diffuse albedo
may be recovered per pixel by solving a linear least squares problem:
%%%%%%%%%%%%%%%%%%%
\begin{equation}\label{eg:bg_ps_lambertian_ls}
	 \min_{\bb{\tilde{N}}} \lVert \bb{X} - \bb{\tilde{N}} \bb{S} \rVert_F
\end{equation}
%%%%%%%%%%%%%%%%%%%
following the notation from \cref{eq:bg_sfs_least_squares_lambert},
assuming $n$ input images of the same width and height ($d$ total pixels) and
$\bb{X} = [\bb{I}_1, \ldots, \bb{I}_n] \in \R^{d \times n}$, 
$\bb{S} = {[\bb{s}_1, \ldots, \bb{s}_n]}^T \in \R^{3 \times n}$ and
$\bb{\tilde{N}} = \nobreak {[\rho_{\smallsub{d}}(x_1, y_1)\bb{n}(x_1, y_1), \ldots, \rho_{\smallsub{d}}(x_w, y_h)\bb{n}(x_w, y_h)]}^T \in \R^{d \times 3}$ is the normal matrix scaled by the diffuse
albedo. \cref{eg:bg_ps_lambertian_ls} is solved via a
pseudoinverse as $\bb{\tilde{N}} = \bb{X} \bb{S}^{\dagger}$ and the norm of each
column of $\bb{\tilde{N}}^T$ recovers the diffuse albedo,
${\rho_{\smallsub{d}}}_i = \norm{\bb{\tilde{n}}_i}$ 
where $\bb{\tilde{n}}_i \in \R^{3 \times 1}$
is the $i$'th column of the transposed normals matrix and $i \in [1, d]$. 
Similarly, the unit normals are recovered by
$\bb{\tilde{n}}_i = \frac{\bb{\tilde{n}}_i}{\norm{\bb{\tilde{n}}_i}}$.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
