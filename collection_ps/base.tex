%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Image Collections: Class-Specific Photometric Stereo}\label{ch:imag_coll}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\minitoc{}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
A common relaxation of the single image shape recovery problem is to reduce
ambiguities by considering more than one image. In the most difficult case,
these images will not have any temporal relationship to one another and thus
will have been captured under a variety of conditions. In the case of
considering illumination constraints for shape recovery a number of images
of a single object in a fixed position under known illumination conditions
may be considered. This family of methods are called Photometric Stereo (PS)
methods and were discussed in detail in \cref{sec:bg_ps}. However, the two
primary constraints, that the illumination conditions are known and that each
image contains pixel-wise correspondence of a single object under the exact
same view, are highly restrictive. The known illumination constraint can be
relaxed by performing
Uncalibrated Photometric Stereo (U-PS)~\cite{hayakawa1994photometric,%
basri2007photometric} which performs remarkably well for
human faces~\cite{KemelmacherShlizerman:2013iv,kemelmacher2011face,%
kemelmacher2012collection}. In contrast, the correspondence problem is an
unrealistic constraint for living objects. Even under highly constrained
scenarios it can be very difficult for a person to remain completely still
whilst multiple images are being captured.
For example, \cref{fig:yaleb_movement_example} shows Subject 6 from the
Yale B~\cite{georghiades2001fromfew} database where 64 images were captured
under different illuminations provided by a geodesic lighting rig in
approximately 2 seconds. Despite the relatively short capture time, the subjects
still often moved during capture which can cause artefacts during 3D surface
recovery. For example, \citet{harrison2012translational} showed that rectifying
translational movements from the Yale B images provided a less biased
reconstruction. However, this kind of translational alignment requires that the
images be approximately aligned to begin with and cannot handle common issues
such as occlusion. It can also not handle the large amount of variation that
may be present between individuals.

In this chapter, we look to borrow from ideas seen within the Photometric Stereo
literature in order to recover shape from objects under unconstrained settings
using \textit{only a set of images}. Typically, these types of unconstrained
photo collections are called ``in-the-wild''. We seek to construct our models in
an automatic manner, without manual feature point placement or careful selection
of the input images.

In particular, we seek to recover the shape of the object by exploiting the
similarity within the object class. In the case of faces, there are millions of
available images that can be utilised to build in-the-wild models. However,
recovering shape from these images is incredibly challenging, as they have been
captured in completely unconstrained conditions. No knowledge of the lighting
conditions, the facial location or the camera geometric properties are provided
with the images. To address these problems, we propose to recover a class
specific spherical harmonic (SH) basis that exploits the low-rank structure of
faces~\cite{georghiades2001fromfew,Basri:2003ie}. Spherical harmonics are ideal for
this purpose as they can be approximated by a low-dimensional linear subspace
\cite{Basri:2003ie,ramamoorthi2001relationship}.
By using the first order SH, $87.5\%$ of
the low-frequency component of the lighting is approximated. The first order SH
can then be used to recover 3D shape as their discrete approximation directly
incorporates the normals of the object.

The most relevant techniques to this chapter involve recovering shape from a
collection of images under varying illumination. Typically, this involves
solving some form of uncalibrated photometric stereo problem
\cite{basri2007photometric,papadhimitri2014closed,papadhimitri2014closed}. However, traditional uncalibrated
photometric stereo techniques still assume that the images provided have been
captured by a photometric stereo system under explicit directed lighting.
The relaxation of the uncalibrated photometric stereo problem to a class of
objects further increases the ambiguity inherent within the problem.
Specifically, it is now necessary to separate the SH lighting from the identity
of the individuals. This problem has been approached for both shape recovery and
facial recognition purposes
\cite{lee2005bilinear,lee2005estimation,minsik2014realtime,minsik2013robust,zhou2007appearance}. 
\citet{lee2005bilinear,lee2005estimation} recover facial shape by separating illumination
from identity in a manner that is similar to 3DMMs. 
\citet{lee2005bilinear,lee2005estimation} separate
\citet{minsik2014realtime,minsik2013robust} the appearance and identity via a low rank
tensor decomposition that provides a very efficient reconstruction methodology.
However, both Lee \etal~and Minsik \etal~still rely on previously built dense 3D
models to perform their decomposition.

Recently, \citet{KemelmacherShlizerman:2013iv} proposed a method for
building morphable models from images of faces downloaded from the Internet.
This work shares similarities with ours in that it attempts to build a subspace
that explicitly separates shape and appearance. However, in~\cite{KemelmacherShlizerman:2013iv}
they do not investigate a robust decomposition, but instead rely on a time
consuming optical flow~\cite{kemelmacher2012collection} based registration process to remove
outliers from the images. Although this methodology allows for expression
transfer, it does not allow the recovered shapes to be used within existing
facial alignment techniques such as Active Appearance Models (AAMs). In
contrast, our use of efficient facial alignment techniques to acquire
correspondence substantially reduces our training time. It also allows our
recovered basis to be coupled with the alignment techniques for simultaneous
facial landmark localisation and dense surface recovery. However, the coarse
geometric alignment we employ is more sensitive to corruptions such as
occlusions and extreme facial pose. For this reason, we employ a low rank
constraint
\cite{candes2011robust,peng2012rasl,sagonas2014raps,cheng2013rank,wu2010robust,lu2013uncalibrated}
to help remove these high frequency errors whilst maintaining the low frequency
lighting variations. Although we share a similar optimisation framework to other
robust principal component analysis problems such as
\cite{candes2011robust,peng2012rasl,wu2010robust,lu2013uncalibrated}, we are the first to propose
a low-rank decomposition that recovers a subspace of spherical harmonics.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}
    \hspace*{\fill}
    \includegraphics[width=0.22\textwidth]{collection_ps/images/yaleb/yaleB06_P00A+000E+20} \hfill
    \includegraphics[width=0.22\textwidth]{collection_ps/images/yaleb/yaleB06_P00A+000E-20} \hfill
    \includegraphics[width=0.22\textwidth]{collection_ps/images/yaleb/yaleB06_P00A+005E-10} \hfill
    \includegraphics[width=0.22\textwidth]{collection_ps/images/yaleb/yaleB06_P00A-020E+10}
    \hspace*{\fill}
\label{fig:yaleb_movement_example}
    \caption{An example of unintentional movement during capture of a live
             human subject, from the Yale-B database~\cite{georghiades2001fromfew}.
             This movement violates the pixel-wise correspondence assumption
             made by traditional Calibrated and Uncalibrated Photometric
             Stereo.}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{collection_ps/method}
\input{collection_ps/experiments}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\stopcontents[chapters]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
