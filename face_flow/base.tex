%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Image Sequences: Face Flow}\label{ch:face_flow}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\minitoc{}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
In the previous chapter, we considered the problem of jointly recovering a
dense representation of shape from an unconstrained image collection. The key
insight was to leverage the shared information about the shape of an object
that is present across many different instances of the object class. This
involved employing shading cues in order to recover a joint representation
of the object class' shape in the form of a spherical harmonic basis. This
basis was estimated by performing a decomposition of the
\textit{aligned images}. This alignment was performed coarsely by assuming the
existence of a set of sparse landmarks that were used to approximate
dense correspondence between all of the images. These sparse landmarks can
be recovered very accurately across a large variety of ``in-the-wild'' facial
images and thus present an attractive method of performing alignment. However,
to perform the decomposition and recover a dense representation of shape, it
is necessary to recover dense correspondences between all of the input images. 
This was achieved by employing a piecewise constant warping function. Unfortunately, a
piecewise warping function only recovers coarse correspondences and may produce
artefacts in the case of extreme expression or head pose. Therefore, it is
desirable to be able to recover a more accurate set of dense correspondences 
between the input images. \citet{KemelmacherShlizerman:2013iv} proposed to
perform this alignment via optical flow~\cite{liu2009beyond} which provides
per-pixel dense correspondence. However, optical flow makes a
strong core assumption, namely the ``brightness constancy'' assumption, which states
that the intensity of a given pixel in the image should not change abruptly
between two differing views of the object. This assumption is clearly
violated between images of different individuals which are guaranteed to
have been captured under different illumination conditions. To aid in this,
\citet{KemelmacherShlizerman:2013iv} employed
Collection Flow~\cite{kemelmacher2012collection} which seeks to normalise
lighting effects between images of differing people. However, 
Collection Flow~\cite{kemelmacher2012collection} is unlikely to work in
scenarios containing occlusions and more severe lighting conditions.
Furthermore, the application of multiple optical flowm stages ensures that Collection
Flow is very costly to compute. In fact, optical flow is most commonly performed
on \textit{image sequences}, where the brightness constancy assumption is
much less likely to be violated. In this chapter, we seek to improve the dense
correspondences recovered between facial images in order to recover a more
accurate 3D surface. Given the difficulty in recovering an accurate pixel-wise
correspondence for ``in-the-wild'' image collections, we concentrate on
\textit{image sequences}. Image sequences of faces, or videos, are equally
as prolific as still images and thus present a readily available source of
input data. Furthermore, facial image sequences are likely to be constantly
illuminated as many sources of video are recorded under controlled lighting
conditions. This is ideal for optical flow methods as the brightness constancy
assumption is maintained. However, unlike in the previous chapter, shading cues
no longer provide a method of recovering dense 3D surfaces. This is due
to the lack of lighting variation which is required for shading based
recovery methods. We propose to recover 3D shape by using existing 3D
surface models which are assumed to be in correspondence with our dense 2D pixel
correspondences. The parameters for the 3D model are then recovered in a manner
similar to that of \citet{aldrian2010linear,aldrian2013inverse}. Therefore,
the primary concern of this chapter is how to efficiently recover dense 
correspondences from a sequence of an emotive face. Given the constraint
that we only seek to estimate correspondences between frames of a human face,
we provide a novel method of computing dense correspondences based on a variation
of a traditional Lucas-Kanade~\cite{lucas1981iterative} optical flow method.
Finally, we employ these correspondences to perform model-based 3D facial shape
recovery.

The remainder of this chapter will proceed a follows: \cref{sec:face_flow_intro}
provides an overview of the optical flow problem and in particular
outlines the challenges of long sequence tracking. \cref{sec:face_flow_method}
outlines our novel face-specific optical flow algorith, which we call
``FaceFlow''. \cref{sec:face_flow_experiments} contains our experimental work
including performance on both synthetic and real sequences for long
sequence optical flow. We also provide examples of model based 3D shape recovery
on real world sequences. Finally, in \cref{sec:face_flow_conclusion},
we provide a summary of the chapter and draw conclusions on our results.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
{
\input{face_flow/commands}

\input{face_flow/introduction}
\input{face_flow/method}
\input{face_flow/experiments}
\input{face_flow/conclusion}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\stopcontents[chapters]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
